import Joi from 'joi';

export const vulnerabilityValidation = {
    createVulnerability: Joi.object({
        title: Joi.string()
            .trim()
            .required()
            .messages({
                'any.required': 'Title is required',
                'string.empty': 'Title cannot be empty'
            }),
        severity: Joi.string()
            .valid('Low', 'Medium', 'High', 'Critical')
            .optional()
            .messages({
                'any.only': 'Severity must be one of: Low, Medium, High, Critical'
            }),
        status: Joi.string()
            .valid('Open', 'Resolved', 'False Positive')
            .optional()
            .messages({
                'any.only': 'Status must be one of: Open, Resolved, False Positive'
            })
    }).unknown(true),

    getVulnerabilitiesQuery: Joi.object({
        page: Joi.number().integer().min(1).default(1).optional(),
        limit: Joi.number().integer().min(1).max(100).default(10).optional(),
        severity: Joi.string().valid('Low', 'Medium', 'High', 'Critical').optional(),
        status: Joi.string().valid('Open', 'Resolved', 'False Positive').optional()
    }).unknown(true)
};

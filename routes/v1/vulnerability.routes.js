import express from "express";
import { VulnerabilityController } from "../../controllers/vulnerability.controller.js";
import { validate } from "../../middlewares/validate.js";
import { vulnerabilityValidation } from "../../validations/vulnerability.validations.js";

const router = express.Router();

router
    .get("/",
        validate(vulnerabilityValidation.getVulnerabilitiesQuery, "query"),
        VulnerabilityController.getVulnerabilities
    )
    .post("/",
        validate(vulnerabilityValidation.createVulnerability, "body"),
        VulnerabilityController.createVulnerability
    )
    .get("/:id", VulnerabilityController.getVulnerabilityById);

export default router;

import { Vulnerability } from "../models/vulnerability.model.js";

export class VulnerabilityService {

    static getVulnerabilities = async ({ page = 1, limit = 10, filters = {} }) => {
        const skip = (page - 1) * limit;

        const data = await Vulnerability.find(filters)
            .sort({ createdAt: -1 })
            .skip(skip)
            .limit(limit);

        const total = await Vulnerability.countDocuments(filters);

        return {
            data,
            meta: {
                pagination: {
                    page,
                    limit,
                    total,
                    pages: Math.ceil(total / limit)
                }
            }
        };
    }

    static createVulnerability = async (vulnData) => {
        const vulnerability = new Vulnerability(vulnData);
        await vulnerability.save();
        return vulnerability;
    }

    static getVulnerabilityById = async (id) => {
        return Vulnerability.findById(id);
    }
}
